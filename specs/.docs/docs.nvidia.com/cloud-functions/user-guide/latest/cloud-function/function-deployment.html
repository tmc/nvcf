<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Function Deployment &mdash; NVIDIA Cloud Functions latest documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/pygments_dark.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme-switcher-general.css" type="text/css" />
      <link rel="stylesheet" href="../_static/omni-style-dark.css" type="text/css" />
      <link rel="stylesheet" href="../_static/api-styles-dark.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/omni-style.css" type="text/css" />
      <link rel="stylesheet" href="../_static/api-styles.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/mermaid-init.js"></script>
        <script src="../_static/external-links.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/theme-setter.js"></script>
        <script src="../_static/design-tabs.js"></script>
        <script src="../_static/version.js"></script>
        <script src="../_static/social-media.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Function Management" href="function-management.html" />
    <link rel="prev" title="Function Creation" href="function-creation.html" />
 

    <script src="https://assets.adobedtm.com/5d4962a43b79/c1061d2c5e7b/launch-191c2462b890.min.js" ></script>
    


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


<a href="../index.html">
  <img src="../_static/nvidia-logo-white.png" class="logo" alt="Logo"/>
</a>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">NVIDIA Cloud Functions</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="elastic-nim.html">Elastic NIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="function-lifecycle.html">Function Lifecycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="function-creation.html">Function Creation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Function Deployment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#deployment-validation">Deployment Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploying-a-function">Deploying a Function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#key-concepts">Key Concepts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#function-queueing">Function Queueing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#autoscaling-and-instance-counts">Autoscaling and Instance Counts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deploy-via-the-ui">Deploy via the UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploy-via-api">Deploy via API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploy-via-cli">Deploy via CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete-a-deployment">Delete a Deployment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deployment-failures">Deployment Failures</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="function-management.html">Function Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="function-monitoring.html">Function Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="function-permissions.html">Function Permissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="assets.html">Asset Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster-management.html">Cluster Setup &amp; Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="account-access.html">NGC Account Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NVIDIA Cloud Functions</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">


<li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
  
<li>Function Deployment</li>

      <li class="wy-breadcrumbs-aside">
      </li>
<li class="wy-breadcrumbs-aside">

  <span>&nbsp;</span>
</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="function-deployment">
<span id="id1"></span><h1>Function Deployment<a class="headerlink" href="#function-deployment" title="Permalink to this headline"></a></h1>
<p>This page describes deployment concepts and steps to deploy a function using Cloud Functions.</p>
<p>A function deployment refers to one or more function instances running on a cluster.</p>
<p>See <a class="reference internal" href="function-lifecycle.html#life-cycle"><span class="std std-ref">Function Lifecycle</span></a> for more key terminology and diagrams.</p>
<section id="deployment-validation">
<span id="validate-deployment"></span><h2>Deployment Validation<a class="headerlink" href="#deployment-validation" title="Permalink to this headline"></a></h2>
<p>If your function is container-based, before deploying, it’s <strong>strongly recommended</strong> to run the local <a class="reference external" href="https://github.com/NVIDIA/nv-cloud-function-helpers/tree/main/local_deployment_test">Deployment Validator</a>, to catch common configuration issues and enable faster development cycles.</p>
<ol class="arabic simple">
<li><p>Clone the helper repository and install the validator:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>&gt; git clone https://github.com/NVIDIA/nv-cloud-function-helpers.git
<span class="linenos">2</span>&gt; <span class="nb">cd</span> nv-cloud-function-helpers/local_deployment_test/
<span class="linenos">3</span>&gt; pip install -r requirements.txt
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Run the validator on your container. Supported validation arguments:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--protocol</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--health-endpoint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--inference-endpoint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--container-port</span></code></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>&gt; python3 test_container.py --image-name <span class="nv">$CONTAINER_IMAGE_NAME</span> --protocol http --health-endpoint v2/health/live --inference-endpoint /v2/models/echo/infer --container-port <span class="m">8000</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Once checks have passed, you’ll be prompted to test out your container’s inference endpoint. Paste your function’s expected inference endpoint JSON request body into the temporary file that is generated. If everything is successful, proceed to deploy your function.</p></li>
</ol>
</section>
<section id="deploying-a-function">
<h2>Deploying a Function<a class="headerlink" href="#deploying-a-function" title="Permalink to this headline"></a></h2>
<p>Before deploying a function, you must create it first. Once created it will be listed as <code class="docutils literal notranslate"><span class="pre">INACTIVE</span></code>. See <a class="reference internal" href="function-creation.html#function-creation"><span class="std std-ref">Function Creation</span></a>.</p>
<p>Your Cloud Functions account will have access to various GPU clusters, instance types and configurations up to a set amount. This is determined by your NVIDIA Account Manager.</p>
<p>Each function version can have a different deployment configuration, allowing for heterogeneous computing infrastructure to be used across a single function endpoint. Once a deployment is created, it can be updated at any time, for example, to change min or max instance counts.</p>
<section id="key-concepts">
<h3>Key Concepts<a class="headerlink" href="#key-concepts" title="Permalink to this headline"></a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Term</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cluster Group (Backend)</p></td>
<td><p>A collection of one or more (though usually one) clusters to deploy on, for example - a CSP such as Azure, OCI, GCP or an NVIDIA-specific cluster like GFN.</p></td>
</tr>
<tr class="row-odd"><td><p>Instance Type</p></td>
<td><p>Each GPU type can support one or more instance types, which are different configurations, such as the number of CPU cores, and the number of GPUs per node.</p></td>
</tr>
<tr class="row-even"><td><p>Min Instances</p></td>
<td><p>The minimum number of instances your function should be deployed on.</p></td>
</tr>
<tr class="row-odd"><td><p>Max Instances</p></td>
<td><p>The maximum number of instances your function is allowed to autoscale to.</p></td>
</tr>
<tr class="row-even"><td><p>Max Concurrency</p></td>
<td><p>The number of simultaneous invocations your container can handle at any given time.</p></td>
</tr>
<tr class="row-odd"><td><p>Function Request Queue</p></td>
<td><p>A first in first out queue that is created during function version deployment, which buffers incoming requests based on function “worker” instance availability.</p></td>
</tr>
<tr class="row-even"><td><p>Autoscaling</p></td>
<td><p>Automatic scaling up or down of instances from minimum instance count to maximum instance count, based on utilization heuristics and queue depth.</p></td>
</tr>
</tbody>
</table>
<section id="function-queueing">
<h4>Function Queueing<a class="headerlink" href="#function-queueing" title="Permalink to this headline"></a></h4>
<p>The below describes cases which trigger functions to queue. Cloud Functions maintains one queue per function version ID.</p>
<p>For synchronous HTTP requests - queuing is triggered when the function reaches its max concurrency limit of requests currently in progress.</p>
<p><strong>Example</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>A single function instance is deployed with a max concurrency is set to 2 and min and max instance count of 1.</p></li>
<li><p>3 invocation requests hit the Cloud Functions API via /pexec endpoint for the function.</p></li>
<li><p>Cloud Functions API will forward 2 function invocation requests.</p></li>
<li><p>The remaining request will be queued, will return 202 and must be handled by <a class="reference internal" href="api.html#invoke"><span class="std std-ref">HTTP polling</span></a>.</p></li>
</ul>
</div></blockquote>
<p>For streaming requests such as gRPC - queuing is triggered when the function reaches its max concurrency limit of current connections.</p>
<p><strong>Example</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>gRPC function is deployed with a max concurrency set to 2 and min and max instance count of 1.</p></li>
<li><p>3 connection requests hit the Cloud Functions gRPC endpoint for the function.</p></li>
<li><p>2 connections will be created to the function.</p></li>
<li><p>The remaining connection request will wait to connect until one of the 2 current connections is closed.</p></li>
</ul>
</div></blockquote>
</section>
<section id="autoscaling-and-instance-counts">
<h4>Autoscaling and Instance Counts<a class="headerlink" href="#autoscaling-and-instance-counts" title="Permalink to this headline"></a></h4>
<p>Autoscaling of function instances will only occur when the maximum instance count is above the minimum instance count. Scale up or down is determined based on proprietary utilization heuristics and the function’s queue depth.</p>
<p>If the minimum instances of the deployment are set to 0, the function status will be <code class="docutils literal notranslate"><span class="pre">ACTIVE</span></code>, but instances <strong>will only be deployed upon first invocation of the function</strong>. After an extended idle period with no requests, the function will scale back down to 0. Therefore, setting minimum instance count to 0 is generally a best practice for saving on hardware costs, with the trade-off of function deployment time. It’s especially useful when longer response times are acceptable for infrequently used functions.</p>
<p>Invocations made while the instance is starting up will be queued until the instance is ready. Refer to <a class="reference internal" href="function-lifecycle.html#function-states"><span class="std std-ref">Function States</span></a> for understanding what each status means.</p>
</section>
</section>
<section id="deploy-via-the-ui">
<h3>Deploy via the UI<a class="headerlink" href="#deploy-via-the-ui" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Once you’ve created a function, click on the kebab menu on the right to configure a deployment.</p></li>
<li><p>First, choose the target cluster, GPU type and instance type.</p>
<blockquote>
<div><img alt="../_images/container-function-deploy.png" class="align-center" src="../_images/container-function-deploy.png" />
</div></blockquote>
</li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Next, set max concurrency, and instance counts.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Your function will be occupying GPUs up to the minimum instance count, even if it’s not necessarily performing work.</p>
<p>By default, autoscaling is enabled for all functions. Therefore, it’s most cost-effective to set the minimum number of instances possible and allow Cloud Functions to autoscale as needed.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>Optionally, set additional deployment specifications. For example, you can do this if the function is compatible across multiple GPU types, or if there are multiple regions you’d like to deploy the same function to.</p></li>
<li><p>Choose “Deploy Function”. Deployment times will vary depending on the cluster selected and available capacity.</p></li>
</ol>
</section>
<section id="deploy-via-api">
<h3>Deploy via API<a class="headerlink" href="#deploy-via-api" title="Permalink to this headline"></a></h3>
<ol class="arabic simple">
<li><p>Ensure you have an API key created, see <a class="reference internal" href="api.html#generate-personal-key"><span class="std std-ref">Generate an NGC Personal API Key</span></a>.</p></li>
<li><p>First, list the available GPU clusters, types and configurations.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> curl --location <span class="s1">&#39;https://api.ngc.nvidia.com/v2/nvcf/clusterGroups&#39;</span> <span class="se">\</span>
<span class="linenos">2</span> --header <span class="s1">&#39;Accept: application/json&#39;</span> <span class="se">\</span>
<span class="linenos">3</span> --header <span class="s1">&#39;Authorization: Bearer $API_KEY&#39;</span> <span class="se">\</span>
</pre></div>
</div>
<p>See an example response below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="o">{</span>
<span class="linenos"> 2</span>     <span class="s2">&quot;clusterGroups&quot;</span>: <span class="o">[</span>
<span class="linenos"> 3</span>         <span class="o">{</span>
<span class="linenos"> 4</span>             <span class="s2">&quot;id&quot;</span>: <span class="s2">&quot;...&quot;</span>,
<span class="linenos"> 5</span>             <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;GCP-ASIASE1-A&quot;</span>,
<span class="linenos"> 6</span>             <span class="s2">&quot;ncaId&quot;</span>: <span class="s2">&quot;...&quot;</span>,
<span class="linenos"> 7</span>             <span class="s2">&quot;authorizedNcaIds&quot;</span>: <span class="o">[</span>
<span class="linenos"> 8</span>                 <span class="s2">&quot;*&quot;</span>
<span class="linenos"> 9</span>             <span class="o">]</span>,
<span class="linenos">10</span>             <span class="s2">&quot;gpus&quot;</span>: <span class="o">[</span>
<span class="linenos">11</span>                 <span class="o">{</span>
<span class="linenos">12</span>                     <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;H100&quot;</span>,
<span class="linenos">13</span>                     <span class="s2">&quot;instanceTypes&quot;</span>: <span class="o">[</span>
<span class="linenos">14</span>                         <span class="o">{</span>
<span class="linenos">15</span>                             <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;a3-highgpu-8g_1x&quot;</span>,
<span class="linenos">16</span>                             <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Single H100 GPU&quot;</span>,
<span class="linenos">17</span>                             <span class="s2">&quot;default&quot;</span>: <span class="nb">true</span>
<span class="linenos">18</span>                         <span class="o">}</span>,
<span class="linenos">19</span>                         <span class="o">{</span>
<span class="linenos">20</span>                             <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;a3-highgpu-8g_4x&quot;</span>,
<span class="linenos">21</span>                             <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Four 80 GB H100 GPU&quot;</span>,
<span class="linenos">22</span>                             <span class="s2">&quot;default&quot;</span>: <span class="nb">false</span>
<span class="linenos">23</span>                         <span class="o">}</span>,
<span class="linenos">24</span>                         <span class="o">{</span>
<span class="linenos">25</span>                             <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;a3-highgpu-8g_2x&quot;</span>,
<span class="linenos">26</span>                             <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Two 80 GB H100 GPU&quot;</span>,
<span class="linenos">27</span>                             <span class="s2">&quot;default&quot;</span>: <span class="nb">false</span>
<span class="linenos">28</span>                         <span class="o">}</span>,
<span class="linenos">29</span>                         <span class="o">{</span>
<span class="linenos">30</span>                             <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;a3-highgpu-8g_8x&quot;</span>,
<span class="linenos">31</span>                             <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Eight 80 GB H100 GPU&quot;</span>,
<span class="linenos">32</span>                             <span class="s2">&quot;default&quot;</span>: <span class="nb">false</span>
<span class="linenos">33</span>                         <span class="o">}</span>
<span class="linenos">34</span>                     <span class="o">]</span>
<span class="linenos">35</span>                 <span class="o">}</span>
<span class="linenos">36</span>             <span class="o">]</span>,
<span class="linenos">37</span>             <span class="s2">&quot;clusters&quot;</span>: <span class="o">[</span>
<span class="linenos">38</span>                 <span class="o">{</span>
<span class="linenos">39</span>                     <span class="s2">&quot;k8sVersion&quot;</span>: <span class="s2">&quot;v1.29.2-gke.1060000&quot;</span>,
<span class="linenos">40</span>                     <span class="s2">&quot;id&quot;</span>: <span class="s2">&quot;...&quot;</span>,
<span class="linenos">41</span>                     <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;nvcf-gcp-prod-asiase1-a&quot;</span>
<span class="linenos">42</span>                 <span class="o">}</span>
<span class="linenos">43</span>             <span class="o">]</span>
<span class="linenos">44</span>         <span class="o">}</span>
<span class="linenos">45</span>         ...
<span class="linenos">46</span>     <span class="o">]</span>
<span class="linenos">47</span> <span class="o">}</span>
</pre></div>
</div>
<p>In this example (which has some data omitted), the account is authorized to deploy on the <code class="docutils literal notranslate"><span class="pre">GCP-ASIASE1-A</span></code> cluster, which has the <code class="docutils literal notranslate"><span class="pre">H100</span></code> GPU type in four different instance type configurations.</p>
<ol class="arabic simple" start="3">
<li><p>Deploy the function via API by creating a deployment specification.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> curl --location <span class="s1">&#39;https://api.ngc.nvidia.com/v2/nvcf/deployments/functions/$FUNCTION_ID/versions/$FUNCTION_VERSION_ID&#39;</span> <span class="se">\</span>
<span class="linenos"> 2</span> --header <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\</span>
<span class="linenos"> 3</span> --header <span class="s1">&#39;Accept: application/json&#39;</span> <span class="se">\</span>
<span class="linenos"> 4</span> --header <span class="s1">&#39;Authorization: Bearer $API_KEY&#39;</span> <span class="se">\</span>
<span class="linenos"> 5</span> --data <span class="s1">&#39;{</span>
<span class="linenos"> 6</span><span class="s1"> &quot;deploymentSpecifications&quot;: [</span>
<span class="linenos"> 7</span><span class="s1">         {</span>
<span class="linenos"> 8</span><span class="s1">             &quot;backend&quot;: &quot;GCP-ASIASE1-A&quot;,</span>
<span class="linenos"> 9</span><span class="s1">             &quot;gpu&quot;: &quot;H100&quot;,</span>
<span class="linenos">10</span><span class="s1">             &quot;minInstances&quot;: &quot;1&quot;</span>
<span class="linenos">11</span><span class="s1">             &quot;maxInstances&quot;: &quot;2&quot;,</span>
<span class="linenos">12</span><span class="s1">             &quot;maxRequestConcurrency&quot;: 1,</span>
<span class="linenos">13</span><span class="s1">         }</span>
<span class="linenos">14</span><span class="s1">     ]</span>
<span class="linenos">15</span><span class="s1"> }&#39;</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Refer to the <a class="reference internal" href="api.html#open-api"><span class="std std-ref">OpenAPI Specification</span></a> for further API documentation.</p></li>
</ol>
</section>
<section id="deploy-via-cli">
<h3>Deploy via CLI<a class="headerlink" href="#deploy-via-cli" title="Permalink to this headline"></a></h3>
<ol class="arabic simple">
<li><p>Ensure you have an API key created, see <a class="reference internal" href="api.html#generate-personal-key"><span class="std std-ref">Generate an NGC Personal API Key</span></a>.</p></li>
<li><p>Ensure you have the <a class="reference internal" href="function-creation.html#ngc-cli-setup"><span class="std std-ref">NGC CLI configured</span></a>.</p></li>
<li><p>First, list the available GPU clusters, types and configurations.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> ngc cloud-function available-gpus
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Deploy the function via CLI by creating a deployment specification.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> ngc cf <span class="k">function</span> deploy create --deployment-specification <span class="nv">$CLUSTER_BACKEND</span>:<span class="nv">$GPU_TYPE</span>:<span class="nv">$INSTANCE_TYPE</span>:<span class="nv">$MIN_INSTANCES</span>:<span class="nv">$MAX_INSTANCES</span> <span class="nv">$FUNCTION_ID</span>:<span class="nv">$FUNCTION_VERSION_ID</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>See <a class="reference external" href="https://docs.ngc.nvidia.com/cli/cmd_cloud-function.html">NGC CLI Documentation</a>. for further commands.</p></li>
</ol>
</section>
<section id="delete-a-deployment">
<h3>Delete a Deployment<a class="headerlink" href="#delete-a-deployment" title="Permalink to this headline"></a></h3>
<p>To delete a function version deployment, supply the function ID and version ID.</p>
<p>Via UI, choose “Disable Function Version” in the Functions List Page for any deployed function and version.</p>
<p>Via API:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>curl -X <span class="s1">&#39;DELETE&#39;</span> <span class="se">\</span>
<span class="linenos">2</span>  <span class="s1">&#39;https://api.nvcf.nvidia.com/v2/nvcf/functions/$FUNCTION_ID&#39;</span>
</pre></div>
</div>
<p>Via CLI:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> ngc cloud-function <span class="k">function</span> deploy remove <span class="nv">$FUNCTION_ID</span>:<span class="nv">$FUNCTION_VERSION_ID</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Specify the <code class="docutils literal notranslate"><span class="pre">graceful</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">true</span></code> to require active function instances to fulfill any in-flight inference requests and drain all requests in the queue before terminating.</p>
<p>When a deployment is deleted, the function’s status will immediately become <code class="docutils literal notranslate"><span class="pre">INACTIVE</span></code> indicating it can no longer serve invocations.</p>
</div>
</section>
</section>
<section id="deployment-failures">
<span id="id2"></span><h2>Deployment Failures<a class="headerlink" href="#deployment-failures" title="Permalink to this headline"></a></h2>
<p>Depending on the size of your containers and models, it can take anywhere from 2 minutes to 30 minutes for your function to deploy, although durations up to 2 hours are permitted. This is also dependent on whether your function is deploying from a cold start, or whether it’s scaling up or down (often much faster due to caching in place). Monitor your function’s instance count and scaling via the <a class="reference internal" href="function-monitoring.html#logging-metrics"><span class="std std-ref">Function Metrics Page</span></a>.</p>
<p>If you believe your function should have deployed already, or if it has entered an error state, review the logs to understand what happened, or reach out to your NVCF Support Team.</p>
<p>Below are some common deployment failures:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Failure Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Function configuration problems</p></td>
<td><p>This occurs due to incorrect inference or health endpoints and ports defined, causing the container to be marked unhealthy. Try running <a class="reference internal" href="#validate-deployment"><span class="std std-ref">Deployment Validation</span></a> on the container locally to rule out configuration issues.</p></td>
</tr>
<tr class="row-odd"><td><p>Inadequate capacity for the chosen cluster</p></td>
<td><p>This will usually be indicated in the deployment failure error message in the UI. Try reducing the number of instances you are requesting or changing the GPU/instance type used by your function.</p></td>
</tr>
<tr class="row-even"><td><p>Container in restart loop</p></td>
<td><p>This will be indicated in the inference container logs (if your container is configured to emit logs) and is fixed by debugging and updating your inferencing container code.</p></td>
</tr>
<tr class="row-odd"><td><p>Model file not found</p></td>
<td><p>This error typically occurs when the inference container expects a model file in a specified location, but the file is not present. Ensure the path for your model files is correct and the necessary files, like <code class="docutils literal notranslate"><span class="pre">config.json</span></code>, are available at that location. The <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file should be located under the <code class="docutils literal notranslate"><span class="pre">/config/models/$model-name</span></code> directory.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
<img src="../_static/NVIDIA-LogoBlack.svg" class="only-light"/>
<img src="../_static/NVIDIA-LogoWhite.svg" class="only-dark"/>

<p class="notices">
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/" target="_blank">Privacy Policy</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/" target="_blank">Manage My Privacy</a>
|
<a href="https://www.nvidia.com/en-us/preferences/start/" target="_blank">Do Not Sell or Share My Data</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/" target="_blank">Terms of Service</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/accessibility/" target="_blank">Accessibility</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/company-policies/" target="_blank">Corporate Policies</a>
|
<a href="https://www.nvidia.com/en-us/product-security/" target="_blank">Product Security</a>
|
<a href="https://www.nvidia.com/en-us/contact/" target="_blank">Contact</a>
</p>

<p>
  Copyright &#169; 2024, NVIDIA Corporation.
</p>

    <p>
      <span class="lastupdated">Last updated on Aug 30, 2024.
      </span></p>

  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

    <script type="text/javascript">if (typeof _satellite !== "undefined") {_satellite.pageBottom();}</script>
    



</body>
</html>